<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrator Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
        }

        .card {
            @apply bg-white p-6 rounded-2xl shadow-lg border border-slate-200 transition-transform hover:scale-[1.01] duration-200;
        }
        
        .action-btn {
            @apply px-3 py-1 rounded-lg font-semibold text-xs transition-colors;
        }

        .user-status-pending {
            @apply bg-yellow-100 text-yellow-800;
        }

        .user-status-approved {
            @apply bg-green-100 text-green-800;
        }

        .user-status-canceled {
            @apply bg-red-100 text-red-800;
        }

        .nav-link {
            @apply px-3 py-1 text-slate-200 hover:text-white transition-colors;
        }
    </style>
</head>

<body class="bg-slate-50 text-slate-800">

    <!-- Header & Navigation -->
    <header class="bg-blue-900 text-white p-6 shadow-xl sticky top-0 z-50">
        <div class="container mx-auto flex flex-col md:flex-row justify-between items-center">
            <h1 class="text-2xl md:text-3xl font-bold mb-2 md:mb-0">Administrator Dashboard</h1>
            <nav class="flex flex-wrap justify-center md:space-x-4 md:flex-row space-x-2 md:space-x-0 items-center">
                <a href="#inn-stats" class="nav-link">Inn Stats</a>
                <a href="#user-management" class="nav-link">Users</a>
                <div class="flex items-center space-x-2 ml-4 mt-2 md:mt-0">
                    <span class="text-sm font-medium">Welcome, Admin!</span>
                </div>
                <button id="logout-btn" class="border border-white text-white font-bold py-1 px-4 rounded-full hover:bg-white hover:text-blue-900 transition-colors ml-4 mt-2 md:mt-0">Logout</button>
            </nav>
        </div>
    </header>

    <!-- Main Content Container -->
    <main class="container mx-auto p-4 md:p-8 space-y-8 max-w-6xl">

        <!-- Overall Summary -->
        <section class="grid grid-cols-1 md:grid-cols-4 gap-6">
            <div class="card bg-blue-100 text-blue-800 border-blue-300 text-center">
                <p class="text-sm font-semibold mb-2">Total Inns Managed</p>
                <div id="total-inns" class="text-5xl font-extrabold"></div>
            </div>
            <div class="card bg-sky-100 text-sky-800 border-sky-300 text-center">
                <p class="text-sm font-semibold mb-2">Total Rooms Available</p>
                <div id="total-rooms" class="text-5xl font-extrabold"></div>
            </div>
            <div class="card bg-cyan-100 text-cyan-800 border-cyan-300 text-center">
                <p class="text-sm font-semibold mb-2">Total Managers</p>
                <div id="total-managers" class="text-5xl font-extrabold"></div>
            </div>
            <div class="card bg-indigo-100 text-indigo-800 border-indigo-300 text-center">
                <p class="text-sm font-semibold mb-2">Total Users</p>
                <div id="total-users" class="text-5xl font-extrabold"></div>
            </div>
        </section>

        <!-- Inn Statistics Section -->
        <section id="inn-stats" class="card mt-8">
            <h2 class="text-2xl font-bold text-blue-800 mb-6">Inn Statistics & Ratings</h2>
            <div id="inn-list" class="space-y-6">
                <!-- Inn cards with sliders will be populated by JS -->
            </div>
        </section>
        
        <!-- User & Role Management Section -->
        <section id="user-management" class="card">
            <h2 class="text-2xl font-bold text-blue-800 mb-6">User & Role Management</h2>
            <div class="overflow-x-auto rounded-lg shadow-inner">
                <table class="w-full text-left table-auto">
                    <thead>
                        <tr class="bg-slate-200 text-slate-600 uppercase text-sm leading-normal">
                            <th class="py-3 px-6 text-left">User Name</th>
                            <th class="py-3 px-6 text-left">Role</th>
                            <th class="py-3 px-6 text-center">Status</th>
                            <th class="py-3 px-6 text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body" class="text-sm font-light">
                        <!-- User rows will be populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Custom Modal/Message Box -->
    <div id="message-modal"
        class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm text-center">
            <h3 id="modal-title" class="text-xl font-bold mb-2 text-slate-800"></h3>
            <p id="modal-message" class="text-slate-700 mb-6"></p>
            <button id="modal-close-btn"
                class="w-full py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors">
                OK
            </button>
        </div>
    </div>
    
    <script>
        // --- Helper functions for UI/UX ---
        const messageModal = document.getElementById('message-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const modalCloseBtn = document.getElementById('modal-close-btn');

        function showMessage(title, message) {
            modalTitle.innerText = title;
            modalMessage.innerText = message;
            messageModal.classList.remove('hidden');
            messageModal.classList.add('flex');
        }

        modalCloseBtn.addEventListener('click', () => {
            messageModal.classList.add('hidden');
            messageModal.classList.remove('flex');
        });

        // --- Data Generation Functions ---
        const innNames = ['Serenity Point Inn', 'Oceanview Retreat', 'Pinecrest Lodge', 'Lakeside Cabins'];
        const innLocations = ['Boracay', 'El Nido', 'Baguio', 'Tagaytay'];
        const userNames = ['Alex Johnson', 'Sarah Lee', 'Michael Chen', 'David Wilson', 'Jane Foster', 'Robert King', 'Lisa Evans', 'Juan Dela Cruz', 'Maria Santos'];
        const userComments = ['Wonderful experience!', 'Great location and good value.', 'Breathtaking views and amazing staff.', 'The best vacation ever!', 'Highly recommend this place.', 'Clean and cozy.', 'Will definitely come back.'];
        const trendTypes = ['Trending Up', 'Trending Down', 'Stable'];
        const users = [];
        const inns = [];

        function getRandomInt(min, max) {
            return Math.floor(Math.random() * (max - min + 1)) + min;
        }

        function generateMockData() {
            // Generate users
            users.length = 0; // Clear the array
            const totalUsers = getRandomInt(10, 50);
            for (let i = 0; i < totalUsers; i++) {
                users.push({
                    id: `u${i + 1}`,
                    name: userNames[getRandomInt(0, userNames.length - 1)],
                    role: 'manager',
                    innId: null,
                    status: i < 2 ? 'approved' : 'pending' // Just for a bit of variety
                });
            }

            // Generate inns
            inns.length = 0; // Clear the array
            const totalInns = getRandomInt(2, 5);
            for (let i = 0; i < totalInns; i++) {
                const totalRooms = getRandomInt(20, 60);
                const roomsAvailable = getRandomInt(5, totalRooms - 5);
                const occupancyRate = ((totalRooms - roomsAvailable) / totalRooms * 100).toFixed(0) + '%';
                const totalRevenue = `â‚±${(getRandomInt(10, 50) * 10000).toLocaleString('en-US')}`;
                
                // Assign a manager to the approved inns
                const manager = users.find(u => u.status === 'approved' && !u.innId);
                if (manager) {
                    manager.innId = `inn${i}`;
                }

                inns.push({
                    id: `inn${i}`,
                    name: innNames[getRandomInt(0, innNames.length - 1)],
                    location: innLocations[getRandomInt(0, innLocations.length - 1)],
                    stats: {
                        totalRevenue: totalRevenue,
                        monthlyBookings: getRandomInt(20, 80),
                        occupancyRate: occupancyRate,
                        roomsAvailable: roomsAvailable,
                        totalRooms: totalRooms,
                        trends: trendTypes[getRandomInt(0, trendTypes.length - 1)]
                    },
                    ratings: Array.from({ length: getRandomInt(1, 3) }, () => ({
                        user: userNames[getRandomInt(0, userNames.length - 1)],
                        rating: getRandomInt(3, 5),
                        comment: userComments[getRandomInt(0, userComments.length - 1)],
                        date: new Date().toISOString().slice(0, 10)
                    }))
                });
            }
        }
        
        // --- Render functions ---
        function renderSummary() {
            document.getElementById('total-inns').innerText = inns.length;
            const totalRooms = inns.reduce((sum, inn) => sum + inn.stats.totalRooms, 0);
            document.getElementById('total-rooms').innerText = totalRooms;
            const totalManagers = users.filter(user => user.role === 'manager').length;
            document.getElementById('total-managers').innerText = totalManagers;
            document.getElementById('total-users').innerText = users.length;
        }

        const slideTimers = {};
        const currentSlides = {};

        function changeSlide(innId, direction) {
            const slidesContainer = document.getElementById(`slides-${innId}`);
            if (!slidesContainer) return;

            const totalSlides = 5;
            let currentSlide = currentSlides[innId] || 0;
            currentSlide = (currentSlide + direction + totalSlides) % totalSlides;
            
            const newTransform = `translateX(-${currentSlide * 100}%)`;
            slidesContainer.style.transform = newTransform;
            currentSlides[innId] = currentSlide;
        }

        function startSlider(innId) {
            if (slideTimers[innId]) {
                clearInterval(slideTimers[innId]);
            }
            slideTimers[innId] = setInterval(() => {
                changeSlide(innId, 1);
            }, 5000);
        }

        function renderInnList() {
            const container = document.getElementById('inn-list');
            container.innerHTML = '';
            
            inns.forEach(inn => {
                const card = document.createElement('div');
                card.className = 'card';
                
                card.addEventListener('mouseenter', () => clearInterval(slideTimers[inn.id]));
                card.addEventListener('mouseleave', () => startSlider(inn.id));

                const stats = [{
                    title: 'Occupancy Rate',
                    value: inn.stats.occupancyRate,
                    color: 'text-green-600'
                }, {
                    title: 'Bookings This Month',
                    value: inn.stats.monthlyBookings,
                    color: 'text-blue-600'
                }, {
                    title: 'Rooms Available',
                    value: `${inn.stats.roomsAvailable}/${inn.stats.totalRooms}`,
                    color: 'text-cyan-600'
                }, {
                    title: 'Total Revenue',
                    value: inn.stats.totalRevenue,
                    color: 'text-purple-600'
                }, {
                    title: 'Trend',
                    value: inn.stats.trends,
                    color: inn.stats.trends === 'Trending Up' ? 'text-emerald-600' : (inn.stats.trends === 'Trending Down' ? 'text-rose-600' : 'text-slate-600')
                }];
                
                const sliderHtml = `
                    <div class="relative w-full overflow-hidden">
                        <div id="slides-${inn.id}" class="flex transition-transform duration-500 ease-in-out" style="transform: translateX(0%);">
                            ${stats.map(stat => `
                                <div class="w-full flex-shrink-0 text-center p-4">
                                    <p class="text-3xl font-bold ${stat.color}">${stat.value}</p>
                                    <p class="text-sm text-slate-500">${stat.title}</p>
                                </div>
                            `).join('')}
                        </div>
                        <!-- Slider Controls -->
                        <button onclick="changeSlide('${inn.id}', -1)"
                            class="absolute top-1/2 left-0 -translate-y-1/2 p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                            </svg>
                        </button>
                        <button onclick="changeSlide('${inn.id}', 1)"
                            class="absolute top-1/2 right-0 -translate-y-1/2 p-2 rounded-full bg-slate-200 hover:bg-slate-300 transition-colors">
                            <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 text-slate-600" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7" />
                            </svg>
                        </button>
                    </div>
                `;

                card.innerHTML = `
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-blue-800">${inn.name}</h3>
                        <span class="text-sm text-slate-500">${inn.location}</span>
                    </div>
                    ${sliderHtml}
                    <div class="mt-4 pt-4 border-t border-slate-200">
                        <h4 class="font-semibold text-slate-700 mb-2">Recent Ratings:</h4>
                        <div class="space-y-2">
                            ${inn.ratings.map(rating => `
                                <div class="p-2 bg-slate-50 rounded-lg text-sm italic border border-slate-200">
                                    <p>"${rating.comment}"</p>
                                    <p class="text-right font-normal text-xs text-slate-500">- ${rating.user}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(card);
                startSlider(inn.id);
            });
        }
        
        function renderUserTable() {
            const tableBody = document.getElementById('users-table-body');
            tableBody.innerHTML = ''; // Clear previous content

            users.forEach(user => {
                const row = document.createElement('tr');
                let statusClass = '';
                let actionsHtml = '';
                const assignedInn = user.innId ? inns.find(inn => inn.id === user.innId)?.name : 'N/A';
                
                switch (user.status) {
                    case 'pending':
                        statusClass = 'user-status-pending';
                        actionsHtml = `
                            <button onclick="approveManager('${user.id}')" class="action-btn bg-green-500 text-white hover:bg-green-600 mr-2">Approve</button>
                            <button onclick="cancelManager('${user.id}')" class="action-btn bg-red-500 text-white hover:bg-red-600">Cancel</button>
                        `;
                        break;
                    case 'approved':
                        statusClass = 'user-status-approved';
                        actionsHtml = `<button onclick="removeManager('${user.id}')" class="action-btn bg-red-500 text-white hover:bg-red-600">Remove Role</button>`;
                        break;
                    case 'canceled':
                        statusClass = 'user-status-canceled';
                        actionsHtml = `<span class="text-red-600 font-bold">Canceled</span>`;
                        break;
                }

                row.className = "border-b border-slate-200 hover:bg-slate-50";
                row.innerHTML = `
                    <td class="py-4 px-6">${user.name}</td>
                    <td class="py-4 px-6">${user.role.toUpperCase()} <span class="text-sm text-slate-500">(${assignedInn})</span></td>
                    <td class="py-4 px-6 text-center"><span class="py-1 px-3 rounded-full text-xs font-bold ${statusClass}">${user.status.toUpperCase()}</span></td>
                    <td class="py-4 px-6 text-center whitespace-nowrap">${actionsHtml}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // --- User management actions ---
        function approveManager(id) {
            const userIndex = users.findIndex(user => user.id === id);
            if (userIndex !== -1) {
                const availableInn = inns.find(inn => !users.some(u => u.innId === inn.id));
                if (availableInn) {
                    users[userIndex].status = 'approved';
                    users[userIndex].innId = availableInn.id;
                    showMessage('Manager Approved', `Manager ${users[userIndex].name} has been approved and assigned to ${availableInn.name}.`);
                } else {
                    showMessage('No Inns Available', 'There are no unassigned inns. Cannot approve a new manager.');
                }
                renderUserTable();
                renderSummary();
            }
        }

        function cancelManager(id) {
            const userIndex = users.findIndex(user => user.id === id);
            if (userIndex !== -1) {
                users[userIndex].status = 'canceled';
                showMessage('Manager Canceled', `Manager ${users[userIndex].name}'s request has been canceled.`);
                renderUserTable();
                renderSummary();
            }
        }
        
        function removeManager(id) {
            const userIndex = users.findIndex(user => user.id === id);
            if (userIndex !== -1) {
                users.splice(userIndex, 1);
                showMessage('Manager Removed', `Manager has been permanently removed.`);
                renderUserTable();
                renderSummary();
            }
        }
        
        // --- Event Listeners ---
        document.getElementById('logout-btn').addEventListener('click', () => {
             showMessage("Logged Out", "You have successfully logged out of the administrator dashboard.");
        });

        // --- Initial Render on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            generateMockData();
            renderSummary();
            renderInnList();
            renderUserTable();
        });
    </script>
</body>
</html>
