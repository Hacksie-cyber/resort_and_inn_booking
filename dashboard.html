<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Administrator Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f1f5f9;
        }

        .card {
            @apply bg-white p-6 rounded-2xl shadow-lg border border-slate-200 transition-transform hover:scale-[1.01] duration-200;
        }
        
        .action-btn {
            @apply px-3 py-1 rounded-lg font-semibold text-xs transition-colors;
        }

        .user-status-pending {
            @apply bg-yellow-100 text-yellow-800;
        }

        .user-status-approved {
            @apply bg-green-100 text-green-800;
        }

        .user-status-canceled {
            @apply bg-red-100 text-red-800;
        }

        .nav-link {
            @apply px-3 py-1 text-slate-200 hover:text-white transition-colors;
        }
    </style>
</head>

<body class="bg-gray-100 text-slate-800">

    <!-- Header & Navigation -->
    <header class="bg-purple-800 text-white p-6 shadow-xl sticky top-0 z-50">
        <div class="container mx-auto flex justify-between items-center">
            <h1 class="text-3xl font-bold">Administrator Dashboard</h1>
            <nav class="space-x-4 flex items-center">
                <a href="#inn-stats" class="nav-link">Inn Stats</a>
                <a href="#user-management" class="nav-link">Users</a>
                <div class="flex items-center space-x-2 bg-purple-700 py-1 px-3 rounded-full ml-4">
                    <span class="text-sm font-medium">Welcome, Admin!</span>
                </div>
                <button id="logout-btn" class="bg-orange-500 text-white font-bold py-1 px-4 rounded-full hover:bg-orange-600 transition-colors">Logout</button>
            </nav>
        </div>
    </header>

    <!-- Main Content Container -->
    <main class="container mx-auto p-4 md:p-8 space-y-8">

        <!-- Overall Summary -->
        <section class="grid grid-cols-1 md:grid-cols-3 gap-6">
            <div class="card bg-purple-100 text-purple-800 border-purple-300 text-center">
                <p class="text-sm font-semibold mb-2">Total Inns Managed</p>
                <div id="total-inns" class="text-5xl font-extrabold"></div>
            </div>
            <div class="card bg-indigo-100 text-indigo-800 border-indigo-300 text-center">
                <p class="text-sm font-semibold mb-2">Total Rooms Available</p>
                <div id="total-rooms" class="text-5xl font-extrabold"></div>
            </div>
            <div class="card bg-pink-100 text-pink-800 border-pink-300 text-center">
                <p class="text-sm font-semibold mb-2">Total Managers</p>
                <div id="total-managers" class="text-5xl font-extrabold"></div>
            </div>
        </section>

        <!-- Inn Statistics Section -->
        <section id="inn-stats" class="card mt-8">
            <h2 class="text-2xl font-bold text-purple-800 mb-6">Inn Statistics & Ratings</h2>
            <div id="inn-list" class="space-y-6">
                <!-- Inn cards will be populated by JS -->
            </div>
        </section>
        
        <!-- User & Role Management Section -->
        <section id="user-management" class="card">
            <h2 class="text-2xl font-bold text-purple-800 mb-6">User & Role Management</h2>
            <div class="overflow-x-auto rounded-lg shadow-inner">
                <table class="w-full text-left table-auto">
                    <thead>
                        <tr class="bg-slate-200 text-slate-600 uppercase text-sm leading-normal">
                            <th class="py-3 px-6 text-left">User Name</th>
                            <th class="py-3 px-6 text-left">Role</th>
                            <th class="py-3 px-6 text-center">Status</th>
                            <th class="py-3 px-6 text-center">Actions</th>
                        </tr>
                    </thead>
                    <tbody id="users-table-body" class="text-sm font-light">
                        <!-- User rows will be populated by JS -->
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <!-- Custom Modal/Message Box -->
    <div id="message-modal"
        class="fixed inset-0 bg-gray-600 bg-opacity-50 hidden items-center justify-center p-4 z-50">
        <div class="bg-white rounded-xl shadow-2xl p-6 w-full max-w-sm text-center">
            <h3 id="modal-title" class="text-xl font-bold mb-2 text-slate-800"></h3>
            <p id="modal-message" class="text-slate-700 mb-6"></p>
            <button id="modal-close-btn"
                class="w-full py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors">
                OK
            </button>
        </div>
    </div>
    
    <script>
        // --- Helper functions for UI/UX ---
        const messageModal = document.getElementById('message-modal');
        const modalTitle = document.getElementById('modal-title');
        const modalMessage = document.getElementById('modal-message');
        const modalCloseBtn = document.getElementById('modal-close-btn');

        function showMessage(title, message) {
            modalTitle.innerText = title;
            modalMessage.innerText = message;
            messageModal.classList.remove('hidden');
            messageModal.classList.add('flex');
        }

        modalCloseBtn.addEventListener('click', () => {
            messageModal.classList.add('hidden');
            messageModal.classList.remove('flex');
        });

        // --- Mock Data ---
        let inns = [{
            id: '1',
            name: 'Serenity Point Inn',
            location: 'Boracay',
            stats: {
                totalRevenue: '₱250,000',
                monthlyBookings: 45,
                occupancyRate: '75%',
                roomsAvailable: 22,
                totalRooms: 35
            },
            ratings: [{
                user: 'John D.',
                rating: 5,
                comment: 'Wonderful experience!',
                date: '2023-11-20'
            }, {
                user: 'Maria S.',
                rating: 4,
                comment: 'Great location and good value.',
                date: '2023-11-18'
            }],
        }, {
            id: '2',
            name: 'Oceanview Retreat',
            location: 'El Nido',
            stats: {
                totalRevenue: '₱420,000',
                monthlyBookings: 60,
                occupancyRate: '88%',
                roomsAvailable: 15,
                totalRooms: 40
            },
            ratings: [{
                user: 'Emily W.',
                rating: 5,
                comment: 'Breathtaking views and amazing staff.',
                date: '2023-11-22'
            }, {
                user: 'David B.',
                rating: 5,
                comment: 'The best vacation ever!',
                date: '2023-11-21'
            }],
        }];
        
        let users = [{
            id: 'u1',
            name: 'Alex Johnson',
            role: 'manager',
            innId: '1',
            status: 'approved'
        }, {
            id: 'u2',
            name: 'Sarah Lee',
            role: 'manager',
            innId: '2',
            status: 'approved'
        }, {
            id: 'u3',
            name: 'Michael Chen',
            role: 'manager',
            innId: null,
            status: 'pending'
        }, {
            id: 'u4',
            name: 'David Wilson',
            role: 'manager',
            innId: null,
            status: 'pending'
        }, {
            id: 'u5',
            name: 'Jane Foster',
            role: 'manager',
            innId: '1',
            status: 'canceled'
        }];


        // --- Render functions ---
        function renderSummary() {
            document.getElementById('total-inns').innerText = inns.length;
            const totalRooms = inns.reduce((sum, inn) => sum + inn.stats.totalRooms, 0);
            document.getElementById('total-rooms').innerText = totalRooms;
            const totalManagers = users.filter(user => user.role === 'manager').length;
            document.getElementById('total-managers').innerText = totalManagers;
        }

        function renderInnList() {
            const container = document.getElementById('inn-list');
            container.innerHTML = '';
            
            inns.forEach(inn => {
                const card = document.createElement('div');
                card.className = 'card';
                card.innerHTML = `
                    <div class="flex justify-between items-center mb-4">
                        <h3 class="text-xl font-bold text-purple-800">${inn.name}</h3>
                        <span class="text-sm text-slate-500">${inn.location}</span>
                    </div>
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4 text-center border-t border-slate-200 pt-4">
                        <div>
                            <p class="text-3xl font-bold text-green-600">${inn.stats.occupancyRate}</p>
                            <p class="text-sm text-slate-500">Occupancy Rate</p>
                        </div>
                        <div>
                            <p class="text-3xl font-bold text-blue-600">${inn.stats.monthlyBookings}</p>
                            <p class="text-sm text-slate-500">Bookings This Month</p>
                        </div>
                        <div>
                            <p class="text-3xl font-bold text-pink-600">${inn.stats.roomsAvailable}/${inn.stats.totalRooms}</p>
                            <p class="text-sm text-slate-500">Rooms Available</p>
                        </div>
                    </div>
                    <div class="mt-4 pt-4 border-t border-slate-200">
                        <h4 class="font-semibold text-slate-700 mb-2">Recent Ratings:</h4>
                        <div class="space-y-2">
                            ${inn.ratings.map(rating => `
                                <div class="p-2 bg-slate-50 rounded-lg text-sm italic border border-slate-200">
                                    <p>"${rating.comment}"</p>
                                    <p class="text-right font-normal text-xs text-slate-500">- ${rating.user}</p>
                                </div>
                            `).join('')}
                        </div>
                    </div>
                `;
                container.appendChild(card);
            });
        }
        
        function renderUserTable() {
            const tableBody = document.getElementById('users-table-body');
            tableBody.innerHTML = ''; // Clear previous content

            users.forEach(user => {
                const row = document.createElement('tr');
                let statusClass = '';
                let actionsHtml = '';
                const assignedInn = user.innId ? inns.find(inn => inn.id === user.innId)?.name : 'N/A';
                
                switch (user.status) {
                    case 'pending':
                        statusClass = 'user-status-pending';
                        actionsHtml = `
                            <button onclick="approveManager('${user.id}')" class="action-btn bg-green-500 text-white hover:bg-green-600 mr-2">Approve</button>
                            <button onclick="cancelManager('${user.id}')" class="action-btn bg-red-500 text-white hover:bg-red-600">Cancel</button>
                        `;
                        break;
                    case 'approved':
                        statusClass = 'user-status-approved';
                        actionsHtml = `<button onclick="removeManager('${user.id}')" class="action-btn bg-red-500 text-white hover:bg-red-600">Remove Role</button>`;
                        break;
                    case 'canceled':
                        statusClass = 'user-status-canceled';
                        actionsHtml = `<span class="text-red-600 font-bold">Canceled</span>`;
                        break;
                }

                row.className = "border-b border-slate-200 hover:bg-slate-50";
                row.innerHTML = `
                    <td class="py-4 px-6">${user.name}</td>
                    <td class="py-4 px-6">${user.role.toUpperCase()} <span class="text-sm text-slate-500">(${assignedInn})</span></td>
                    <td class="py-4 px-6 text-center"><span class="py-1 px-3 rounded-full text-xs font-bold ${statusClass}">${user.status.toUpperCase()}</span></td>
                    <td class="py-4 px-6 text-center whitespace-nowrap">${actionsHtml}</td>
                `;
                tableBody.appendChild(row);
            });
        }
        
        // --- User management actions ---
        function approveManager(id) {
            const userIndex = users.findIndex(user => user.id === id);
            if (userIndex !== -1) {
                const availableInn = inns.find(inn => !users.some(u => u.innId === inn.id));
                if (availableInn) {
                    users[userIndex].status = 'approved';
                    users[userIndex].innId = availableInn.id;
                    showMessage('Manager Approved', `Manager ${users[userIndex].name} has been approved and assigned to ${availableInn.name}.`);
                } else {
                    showMessage('No Inns Available', 'There are no unassigned inns. Cannot approve a new manager.');
                }
                renderUserTable();
                renderSummary();
            }
        }

        function cancelManager(id) {
            const userIndex = users.findIndex(user => user.id === id);
            if (userIndex !== -1) {
                users[userIndex].status = 'canceled';
                showMessage('Manager Canceled', `Manager ${users[userIndex].name}'s request has been canceled.`);
                renderUserTable();
                renderSummary();
            }
        }
        
        function removeManager(id) {
            const userIndex = users.findIndex(user => user.id === id);
            if (userIndex !== -1) {
                users.splice(userIndex, 1);
                showMessage('Manager Removed', `Manager has been permanently removed.`);
                renderUserTable();
                renderSummary();
            }
        }
        
        // --- Event Listeners ---
        document.getElementById('logout-btn').addEventListener('click', () => {
             showMessage("Logged Out", "You have successfully logged out of the administrator dashboard.");
        });

        // --- Initial Render on Page Load ---
        document.addEventListener('DOMContentLoaded', () => {
            renderSummary();
            renderInnList();
            renderUserTable();
        });
    </script>
</body>
</html>
